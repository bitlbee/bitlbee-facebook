name: CI

on:
  - pull_request
  - push

jobs:
  build:
    runs-on: ubuntu-16.04

    steps:
    - uses: actions/checkout@v2
    - name: Dependencies
      run: |
        #echo "deb http://download.opensuse.org/repositories/openSUSE:/Tools/xUbuntu_$(lsb_release -rs) ./" \
        #  | sudo tee /etc/apt/sources.list.d/suse.list
        #curl -s "http://download.opensuse.org/repositories/openSUSE:/Tools/xUbuntu_$(lsb_release -rs)/Release.key" \
        #  | sudo apt-key add -
        sudo apt-get update -y
        sudo apt-get install -y --no-install-recommends clang git make pkg-config libgnutls28-dev #osc
    - name: bitlbee
      run: ./.travis/bitlbee.sh
    - name: bitlbee-facebook
      run: |
        CFLAGS="-Werror" ./autogen.sh --enable-warnings
        make all clean
        scan-build -k --status-bugs make all clean
